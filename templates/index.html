{% extends "base.html" %}

{% block title %}Home - Google Calendar Meeting Assistant{% endblock %}

{% block messages %}
{% if chat_message %}
<script>
    // Pass chat message to JavaScript
    document.addEventListener('DOMContentLoaded', function() {
        const chatMessageData = document.getElementById('chatMessageData');
        if (chatMessageData) {
            chatMessageData.dataset.message = '{{ chat_message | tojson }}';
        }
    });
</script>
{% endif %}

{% if action_message %}
{# Pass action message (cancelled/updated meeting) to JavaScript #}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const chatMessageData = document.getElementById('chatMessageData');
        if (chatMessageData) {
            chatMessageData.dataset.message = '{{ action_message | tojson }}';
        }
    });
</script>
{% endif %}

{% if authenticated %}
{# Main chat interface - chat history loaded by JavaScript from localStorage #}
<div id="mainPage" style="display: none;"></div>
{% else %}
<div class="message bot">
    <span class="message-icon">ğŸ”</span>
    <div class="message-bubble">
        <h3>Authentication Required</h3>
        <p>Please connect your Google Calendar to use the meeting assistant.</p>
        <a href="/authorize" class="quick-action-btn" style="background: #4285f4; color: white; border: none;">ğŸ”— Connect Google Calendar</a>
    </div>
</div>
{% endif %}
{% endblock %}
